schema: '2.0'
stages:
  prepare_data:
    cmd: mkdir -p prepared_data && uv run src/prepare_data.py && uv run 
      src/validate_data.py
    deps:
    - path: data/test.csv
      hash: md5
      md5: 7533b82eae4b582610cbd68aa636b017
      size: 28629
    - path: data/train.csv
      hash: md5
      md5: 2309cc5f04782ed9bb6016d9f4e381cf
      size: 61194
    - path: src/prepare_data.py
      hash: md5
      md5: bcd12a8b2a4036f7825c8f83d4619cb7
      size: 2096
    - path: src/validate_data.py
      hash: md5
      md5: fddb1dff6d741965675c7c37c2fa3c1b
      size: 2732
    params:
      params.yaml:
        base.random_seed: 42
        data.val_split: 0.15
    outs:
    - path: prepared_data/
      hash: md5
      md5: 64446be3de925416a0dd12f5e6d3d81d.dir
      size: 224483
      nfiles: 3
  data_to_tensors:
    cmd: mkdir -p tensor_data && uv run src/data_to_tensors.py
    deps:
    - path: prepared_data/
      hash: md5
      md5: 64446be3de925416a0dd12f5e6d3d81d.dir
      size: 224483
      nfiles: 3
    - path: src/data_to_tensors.py
      hash: md5
      md5: 089fd1901dde6ba9d7315a91c8879f9d
      size: 799
    outs:
    - path: tensor_data/
      hash: md5
      md5: 9baba9c5b6483bb63ec6ba7b429cd347.dir
      size: 135642
      nfiles: 2
  tune_nn:
    cmd: uv run src/tune_nn.py
    deps:
    - path: src/model.py
      hash: md5
      md5: e97057b22b44b73dd14f6d7d3f2edf15
      size: 2676
    - path: src/tune_nn.py
      hash: md5
      md5: 1bd8243f34fc99a92990267c21615636
      size: 2813
    - path: tensor_data/
      hash: md5
      md5: 9baba9c5b6483bb63ec6ba7b429cd347.dir
      size: 135642
      nfiles: 2
    params:
      params.yaml:
        tracking_server.experiment_name: mlops-workflow
        training:
          n_trials: 100
          batch_size: 64
          epochs: 10
  train_nn:
    cmd: uv run src/train_nn.py
    deps:
    - path: src/model.py
      hash: md5
      md5: e97057b22b44b73dd14f6d7d3f2edf15
      size: 2676
    - path: src/train_nn.py
      hash: md5
      md5: 8847f04285be6520d3b87013210d9d37
      size: 1364
    - path: tensor_data/
      hash: md5
      md5: 9baba9c5b6483bb63ec6ba7b429cd347.dir
      size: 135642
      nfiles: 2
    params:
      params.yaml:
        model_params.nn:
          lr: 0.38745095611548397
          momentum: 0.6820577390413722
        tracking_server.experiment_name: mlops-workflow
  predict_nn:
    cmd: uv run src/predict_nn.py
    deps:
    - path: prepared_data/
      hash: md5
      md5: 64446be3de925416a0dd12f5e6d3d81d.dir
      size: 224483
      nfiles: 3
    - path: src/predict_nn.py
      hash: md5
      md5: 935120ef8c6aa9a9a13c71f51a8828f3
      size: 812
    params:
      params.yaml:
        predict:
          model_name: nn-1
          model_version: 1
